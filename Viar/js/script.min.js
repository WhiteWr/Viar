"use strict";const spollersArray=document.querySelectorAll("[data-spollers]");if(spollersArray.length>0){const e=Array.from(spollersArray).filter((function(e,t,s){return!e.dataset.spollers.split(",")[0]}));e.length>0&&initSpollers(e);const t=Array.from(spollersArray).filter((function(e,t,s){return e.dataset.spollers.split(",")[0]}));if(t.length>0){const e=[];t.forEach(t=>{const s={},n=t.dataset.spollers.split(",");s.value=n[0],s.type=n[1]?n[1].trim():"max",s.item=t,e.push(s)});let s=e.map((function(e){return"("+e.type+"-width: "+e.value+"px),"+e.value+","+e.type}));s=s.filter((function(e,t,s){return s.indexOf(e)===t})),s.forEach(t=>{const s=t.split(","),n=s[1],o=s[2],r=window.matchMedia(s[0]),i=e.filter((function(e){if(e.value===n&&e.type===o)return!0}));r.addListener((function(){initSpollers(i,r)})),initSpollers(i,r)})}function initSpollers(e,t=!1){e.forEach(e=>{e=t?e.item:e,t.matches||!t?(e.classList.add("_init"),initSpollersBody(e),e.addEventListener("click",setSpollerAction)):(e.classList.remove("_init"),initSpollersBody(e,!1),e.removeEventListener("click",setSpollerAction))})}function initSpollersBody(e,t=!0){const s=e.querySelectorAll("[data-spoller]");s.length>0&&s.forEach(e=>{t?(e.removeAttribute("tabindex"),e.classList.contains("_active")||(e.nextElementSibling.hidden=!0)):(e.setAttribute("tabindex","-1"),e.nextElementSibling.hidden=!1)})}function setSpollerAction(e){const t=e.target;if(t.hasAttribute("data-spoller")||t.closest("[data-spoller]")){const s=t.hasAttribute("data-spoller")?t:t.closest("[data-spoller]"),n=s.closest("[data-spollers]"),o=!!n.hasAttribute("data-one-spoller");n.querySelectorAll("._slide").length||(o&&!s.classList.contains("_active")&&hideSpollerBody(n),s.classList.toggle("_active"),_slideToggle(s.nextElementSibling,500)),e.preventDefault()}}function hideSpollerBody(e){const t=e.querySelector("[data-spoller]._active");t&&(t.classList.remove("_active"),_slideUp(t.nextElementSibling,500))}}let _slideUp=(e,t=500)=>{e.classList.contains("_slide")||(e.classList.add("_slide"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout(()=>{e.hidden=!0,e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("_slide")},t))},_slideDown=(e,t=500)=>{if(!e.classList.contains("_slide")){e.classList.add("_slide"),e.hidden&&(e.hidden=!1);let s=e.offsetHeight;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=s+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("_slide")},t)}},_slideToggle=(e,t=500)=>e.hidden?_slideDown(e,t):_slideUp(e,t),isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};function textWebp(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)}}textWebp((function(e){1==e&&document.querySelector("body").classList.add("webp")}));const urlServer="http://localhost:3000",saleUrl="json/sale.json",artsUrl="json/arts.json",headers={"Content-Type":"application/json"};window.onload=function(){window.innerWidth<992&&isMobile.any()&&(setTimeout(()=>{document.querySelector(".menu__lang").style.display="block"},300),function(){document.querySelector(".menu__body");const e=document.querySelector(".contacts-menu"),t=document.querySelector(".menu__menu-hold"),s=document.querySelector(".menu__lang");t.insertBefore(e,t.children[0]),t.insertBefore(s,t.children[1])}()),document.addEventListener("click",(function(n){const r=n.target;if(window.innerWidth>=768&&isMobile.any()&&(r.classList.contains("menu__arrow")&&r.closest(".menu__item").classList.toggle("_hover"),!r.closest(".menu__item")&&document.querySelectorAll(".menu__item._hover").length>0)){document.querySelectorAll(".menu__item._hover").forEach(e=>{e.removeClass("_hover")})}r.closest(".menu__icon")&&e();!r.closest(".menu__icon")&&!r.closest(".menu__menu-hold")&&window.innerWidth>=768&&window.innerWidth<992&&e("close");if(r.closest(".lang-menu__visible")&&!document.querySelector(".lang-menu__visible").classList.contains("_hold"))document.querySelector(".lang-menu__visible").classList.add("_hold"),document.querySelectorAll(".lang-menu__option").forEach(e=>{e.classList.contains("_active")&&e.classList.remove("_active"),e.style.transform="translate(0, 0)"});else if(r.closest(".lang-menu__option")&&document.querySelector(".lang-menu__visible").classList.contains("_hold")){const e=r.getAttribute("data-value"),t=document.querySelector(".lang-menu__list");document.querySelector(".lang-menu__select").setAttribute("value",e);const s=document.querySelectorAll(".lang-menu__option"),n=Array.from(s).findIndex((e,t,s)=>e==r?t:null),o=s.length;-1!=n&&(r.style.transform=`translate(0, -${100*(o-1)}%)`),-1!=n&&window.innerWidth<992&&(r.style.transform=`translate(-${100*(o-1)}%, 0)`),r.classList.add("_active"),document.querySelector(".lang-menu__visible").classList.remove("_hold"),setTimeout(()=>{r.style.transform="translate(0, 0)",t.insertBefore(r,t.children[0])},300)}!r.closest(".lang-menu__visible")&&document.querySelector(".lang-menu__visible").classList.contains("_hold")&&document.querySelector(".lang-menu__visible").classList.remove("_hold");if(r.closest(".forms-sale__item")){const e=r.querySelector("input"),t=document.querySelector(".forms-sale__qustion._active");t.querySelectorAll("li.forms-sale__item input[type = radio]").forEach(e=>{e.hasAttribute("checked")&&(e.removeAttribute("checked"),e.parentElement.classList.remove("_active"))}),e.setAttribute("checked",""),s()}if(r.closest(".forms-sale__button")&&!r.closest(".forms-sale__button_prev")&&!r.closest(".forms-sale__button_send")){const e=document.querySelector("[data-step]").getAttribute("data-step");document.querySelector("[data-step]").setAttribute("data-step",Number(e)+1);document.querySelectorAll("[data-stepId]"),new Promise((e,t)=>{setTimeout(()=>{o(),e()},100)})}if(r.closest(".forms-sale__button_prev")){const e=document.querySelector("[data-step]").getAttribute("data-step");document.querySelector("[data-step]").setAttribute("data-step",Number(e)-1);document.querySelectorAll("[data-stepId]"),new Promise((e,t)=>{setTimeout(()=>{o(),e()},100)})}r.closest(".forms-sale__button_send")&&(!async function(){const e=document.querySelectorAll('[name="saleForm"]'),t=[];e.forEach(e=>{t.push(e.querySelector("input[checked]").value)});let s=await fetch(urlServer,{method:"POST",headers:headers,body:t});s.ok?alert("Request is enter"):alert("Error "+s.status)}(),n.preventDefault());r.closest(".forms-contact-us__button")&&(!async function(){const e=document.forms.contactUsForm,t=e.querySelector('input[type="file"]').value,s=e.querySelector('input[type="email"]').value,n=e.querySelector('input[type="tel"]').value;let o={file:t,email:s,phone:n},r=await fetch(urlServer,{method:"POST",headers:headers,body:o});r.ok?alert("Request is enter"):alert("Error "+r.status)}(),n.preventDefault());r.classList.contains("arts__showMore")&&(!async function(e){if(!e.classList.contains("_hold")){e.classList.add("_hold"),e.setAttribute("disabled","");let s=await fetch(artsUrl,{method:"GET",headers:headers});if(s.ok){!function(e){const s=document.querySelector("._end");e.arts.forEach(e=>{e.id;const t=e.url,n=e.title,o=e.image;var r=`\n\t\t\t\t<article class="arts__item item-arts">\n               <h3 class="item-arts__title">${n}</h3>\n               <div class="item-arts__body">\n                  <a href="${t}" class="item-arts__image">\n                     <picture>\n                        <source srcset="img/arts/${o}.webp" type="image/webp">\n                        <img src="img/arts/${o}.png" alt="#">\n                     </picture>\n                  </a>\n               </div>\n               <div class="item-arts__text">${e.text}</div>\n               <div class="item-arts__price">от <span>${e.price}</span></div>\n               <button type="button" class="item-arts__buy btn">Заказать</button>\n            </article>\n         `;s.insertAdjacentHTML("afterend",r)}),t()}(await s.json()),e.classList.remove("_hold"),e.remove()}else alert("Error")}}(r),n.preventDefault())})),document.querySelectorAll(".menu__item").forEach(e=>{e.addEventListener("mouseleave",e=>{const t=e.target;t.hasAttribute("disabled")||(t.setAttribute("disabled",""),setTimeout(()=>{t.removeAttribute("disabled")},360))})});const e=function(){let e="close";return function(t){const s=document.querySelector(".icon-menu"),n=document.querySelector(".menu");"close"===e&&"close"!==t?(window.innerWidth<768&&document.body.classList.add("_lock"),n.classList.add("_active"),s.classList.add("_active"),e="open"):"open"===e&&"open"!==t&&(window.innerWidth<768&&document.body.classList.remove("_lock"),n.classList.remove("_active"),s.classList.remove("_active"),e="close")}}();function t(){const e=document.querySelectorAll(".item-arts__image");e.length>0&&e.forEach(e=>{e.querySelector("img").naturalWidth<e.querySelector("img").naturalHeight&&e.classList.add("_vertical"),e.classList.add("_done")})}function s(){document.querySelectorAll("li.forms-sale__item input[type = radio]").forEach(e=>{if(e.hasAttribute("checked"))return e.parentElement.classList.add("_active"),e.parentElement;!e.hasAttribute("checked")&&e.parentElement.classList.contains("_active")&&e.parentElement.classList.remove("_active")})}function n(){window.innerWidth;const e=document.forms.saleForm,t=document.querySelectorAll(".forms-sale__list"),s=52*e.querySelectorAll(".forms-sale__item").length/2;t.forEach(e=>{e.style.maxHeight=s,e.style.transform=null}),window.innerWidth<992&&t.forEach(e=>{e.style.transform="translate(-25%)"}),window.innerWidth<530&&t.forEach(e=>{e.style.maxHeight=null,e.style.transform=null})}function o(){const e=document.querySelector("[data-step]").getAttribute("data-step"),t=document.querySelectorAll("[data-stepId]"),s=t[t.length-1].getAttribute("data-stepId");t.forEach(t=>{if(t.classList.contains("_active")?t.classList.remove("_active"):t.classList.contains("_view")&&t.classList.remove("_view"),t.classList.contains("_next")?t.classList.remove("_next"):t.classList.contains("_prev")&&t.classList.remove("_prev"),t.getAttribute("data-stepId")==e&&t.classList.add("_active"),t.getAttribute("data-stepId")-1==e&&!t.classList.contains("forms-sale__qustion")&&t.classList.add("_view"),t.getAttribute("data-stepId")==s&&s==e&&!t.classList.contains("forms-sale__qustion")){const e=document.querySelector(`[data-stepId = "${s-1}"]`);e.classList.add("_view"),e.classList.contains("_prev")&&e.classList.remove("_prev")}t.getAttribute("data-stepId")>e&&!t.classList.contains("_view")&&t.classList.add("_next"),t.getAttribute("data-stepId")<e&&t.classList.add("_prev")});const n=document.querySelector("[data-step]"),o=`<span data-step="${e}">${e}</span>`;n.insertAdjacentHTML("afterend",o),n.remove()}!function(){const e=document.forms.contactUsForm,t=e.contactUsInput,s=e.contactUsPhoto;t.forEach(e=>{const t=e.getAttribute("placeholder");e.addEventListener("focus",(function(t){e.setAttribute("placeholder",""),e.parentElement.classList.add("_focus")})),e.addEventListener("blur",(function(s){e.setAttribute("placeholder",t),e.value||e.parentElement.classList.remove("_focus")}))}),s.addEventListener("change",()=>{if(s.value.length>35){let n="",o="";for(var t=0;t<s.value.length;t++){let e=String(s.value[t]);if("\\"===e&&(n=String(s.value[t+1])+String(s.value[t+2])+String(s.value[t+3])),"."===e){let n=String(s.value).split(e);o=String(s.value[t-2])+String(s.value[t-1])+e+n[1]}}let r=String(s.value).split(n)[0]+n+"..."+o;e.querySelector(".forms-contact-us__title_photo").innerHTML=`<div class="forms-contact-us__title_photo">Загружено фото <span>${r}</span></div>`}else e.querySelector(".forms-contact-us__title_photo").innerHTML=`<div class="forms-contact-us__title_photo">Загружено фото <span>${s.value}</span></div>`})}(),t(),async function(){await async function(e){const t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){return function(e){const t=document.querySelector(".forms-sale__body");let r=0;const i=e[e.length-1].id;return e.forEach(e=>{const s=e.id,n=e.title,o=e.values;let l=0,a="",c="",d="";r>0&&(c='\n            <button type="button" class="forms-sale__button forms-sale__button_prev _icon-angle-down btn">Предыдущий шаг</button>\n            ',d='\n            style="width: 180px;"\n            '),o.forEach(e=>{let t="";0==l&&(t="checked"),a+=`\n            <li class="forms-sale__item"><input type="radio" ${t} name="radioSale" value="${l}" class="forms-sale__radio">${e}</li>\n            `,l++});let u=`<button type="button" class="forms-sale__button _icon-angle-down btn" ${d}>Следующий шаг</button>`;i==s&&(u=`<button type="button" class="forms-sale__button forms-sale__button_send _icon-angle-down btn" ${d}>Отправить</button>`);let m=`\n         <div data-stepId="${s}" class="forms-sale__qustion">\n            <div class="forms-sale__title">${n}</div>\n            <form action="#" name="saleForm" class="forms-sale__form">\n               <ul class="forms-sale__list">\n                  ${a}\n               </ul>\n            </form>\n            <div class="forms-sale__box-button">\n               ${c}\n               ${u}\n            </div>\n         </div>\n         `;r++,t.insertAdjacentHTML("beforeend",m)}),o(),s(),n(),!0}(await t.json())}}(saleUrl)&&window.addEventListener("resize",()=>{n()})}()};