"use strict";const spollersArray=document.querySelectorAll("[data-spollers]");if(spollersArray.length>0){const t=Array.from(spollersArray).filter((function(t,e,s){return!t.dataset.spollers.split(",")[0]}));t.length>0&&initSpollers(t);const e=Array.from(spollersArray).filter((function(t,e,s){return t.dataset.spollers.split(",")[0]}));if(e.length>0){const t=[];e.forEach(e=>{const s={},o=e.dataset.spollers.split(",");s.value=o[0],s.type=o[1]?o[1].trim():"max",s.item=e,t.push(s)});let s=t.map((function(t){return"("+t.type+"-width: "+t.value+"px),"+t.value+","+t.type}));s=s.filter((function(t,e,s){return s.indexOf(t)===e})),s.forEach(e=>{const s=e.split(","),o=s[1],n=s[2],r=window.matchMedia(s[0]),i=t.filter((function(t){if(t.value===o&&t.type===n)return!0}));r.addListener((function(){initSpollers(i,r)})),initSpollers(i,r)})}function initSpollers(t,e=!1){t.forEach(t=>{t=e?t.item:t,e.matches||!e?(t.classList.add("_init"),initSpollersBody(t),t.addEventListener("click",setSpollerAction)):(t.classList.remove("_init"),initSpollersBody(t,!1),t.removeEventListener("click",setSpollerAction))})}function initSpollersBody(t,e=!0){const s=t.querySelectorAll("[data-spoller]");s.length>0&&s.forEach(t=>{e?(t.removeAttribute("tabindex"),t.classList.contains("_active")||(t.nextElementSibling.hidden=!0)):(t.setAttribute("tabindex","-1"),t.nextElementSibling.hidden=!1)})}function setSpollerAction(t){const e=t.target;if(e.hasAttribute("data-spoller")||e.closest("[data-spoller]")){const s=e.hasAttribute("data-spoller")?e:e.closest("[data-spoller]"),o=s.closest("[data-spollers]"),n=!!o.hasAttribute("data-one-spoller");o.querySelectorAll("._slide").length||(n&&!s.classList.contains("_active")&&hideSpollerBody(o),s.classList.toggle("_active"),_slideToggle(s.nextElementSibling,500)),t.preventDefault()}}function hideSpollerBody(t){const e=t.querySelector("[data-spoller]._active");e&&(e.classList.remove("_active"),_slideUp(e.nextElementSibling,500))}}let _slideUp=(t,e=500)=>{t.classList.contains("_slide")||(t.classList.add("_slide"),t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=t.offsetHeight+"px",t.offsetHeight,t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.marginTop=0,t.style.marginBottom=0,window.setTimeout(()=>{t.hidden=!0,t.style.removeProperty("height"),t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("_slide")},e))},_slideDown=(t,e=500)=>{if(!t.classList.contains("_slide")){t.classList.add("_slide"),t.hidden&&(t.hidden=!1);let s=t.offsetHeight;t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.marginTop=0,t.style.marginBottom=0,t.offsetHeight,t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=s+"px",t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),window.setTimeout(()=>{t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("_slide")},e)}},_slideToggle=(t,e=500)=>t.hidden?_slideDown(t,e):_slideUp(t,e),isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};function textWebp(t){var e=new Image;e.onload=e.onerror=function(){t(2==e.height)}}textWebp((function(t){1==t&&document.querySelector("body").classList.add("webp")}));const iconMenu=document.querySelector(".menu__icon"),iconContainer=document.querySelector(".icon-menu__container");if(iconMenu){const t=document.querySelector(".menu");iconMenu.addEventListener("click",(function(e){document.body.classList.toggle("_lock"),iconMenu.classList.toggle("_active"),t.classList.toggle("_active"),iconContainer.classList.toggle("_active")}))}const urlServer="http://localhost:3000",saleUrl="json/sale.json",artsUrl="json/arts.json",headers={"Content-Type":"application/json"};window.onload=function(){function t(){const t=document.querySelectorAll(".item-arts__image");t.length>0&&t.forEach(t=>{t.querySelector("img").naturalWidth<t.querySelector("img").naturalHeight&&t.classList.add("_vertical")})}function e(){document.querySelectorAll("li.forms-sale__item input[type = radio]").forEach(t=>{if(t.hasAttribute("checked"))return t.parentElement.classList.add("_active"),t.parentElement;!t.hasAttribute("checked")&&t.parentElement.classList.contains("_active")&&t.parentElement.classList.remove("_active")})}function s(){window.innerWidth;const t=document.forms.saleForm,e=document.querySelectorAll(".forms-sale__list"),s=52*t.querySelectorAll(".forms-sale__item").length/2;e.forEach(t=>{t.style.maxHeight=s,t.style.transform=null}),window.innerWidth<992&&e.forEach(t=>{t.style.transform="translate(-25%)"}),window.innerWidth<530&&e.forEach(t=>{t.style.maxHeight=null,t.style.transform=null})}function o(){const t=document.querySelector("[data-step]").getAttribute("data-step"),e=document.querySelectorAll("[data-stepId]"),s=e[e.length-1].getAttribute("data-stepId");e.forEach(e=>{if(e.classList.contains("_active")?e.classList.remove("_active"):e.classList.contains("_view")&&e.classList.remove("_view"),e.classList.contains("_next")?e.classList.remove("_next"):e.classList.contains("_prev")&&e.classList.remove("_prev"),e.getAttribute("data-stepId")==t&&e.classList.add("_active"),e.getAttribute("data-stepId")-1==t&&!e.classList.contains("forms-sale__qustion")&&e.classList.add("_view"),e.getAttribute("data-stepId")==s&&s==t&&!e.classList.contains("forms-sale__qustion")){const t=document.querySelector(`[data-stepId = "${s-1}"]`);t.classList.add("_view"),t.classList.contains("_prev")&&t.classList.remove("_prev")}e.getAttribute("data-stepId")>t&&!e.classList.contains("_view")&&e.classList.add("_next"),e.getAttribute("data-stepId")<t&&e.classList.add("_prev")});const o=document.querySelector("[data-step]"),n=`<span data-step="${t}">${t}</span>`;o.insertAdjacentHTML("afterend",n),o.remove()}document.addEventListener("click",(function(s){const n=s.target;if(window.innerWidth>=768&&isMobile.any()&&(n.classList.contains("menu__arrow")&&n.closest(".menu__item").classList.toggle("_hover"),!n.closest(".menu__item")&&document.querySelectorAll(".menu__item._hover").length>0)){document.querySelectorAll(".menu__item._hover").forEach(t=>{t.removeClass("_hover")})}if(n.closest(".forms-sale__item")){const t=n.querySelector("input"),s=document.querySelector(".forms-sale__qustion._active");s.querySelectorAll("li.forms-sale__item input[type = radio]").forEach(t=>{t.hasAttribute("checked")&&(t.removeAttribute("checked"),t.parentElement.classList.remove("_active"))}),t.setAttribute("checked",""),e()}if(n.closest(".forms-sale__button")&&!n.closest(".forms-sale__button_prev")&&!n.closest(".forms-sale__button_send")){const t=document.querySelector("[data-step]").getAttribute("data-step");document.querySelector("[data-step]").setAttribute("data-step",Number(t)+1);document.querySelectorAll("[data-stepId]"),new Promise((t,e)=>{setTimeout(()=>{o(),t()},100)})}if(n.closest(".forms-sale__button_prev")){const t=document.querySelector("[data-step]").getAttribute("data-step");document.querySelector("[data-step]").setAttribute("data-step",Number(t)-1);document.querySelectorAll("[data-stepId]"),new Promise((t,e)=>{setTimeout(()=>{o(),t()},100)})}n.closest(".forms-sale__button_send")&&(!async function(){const t=document.querySelectorAll('[name="saleForm"]'),e=[];t.forEach(t=>{e.push(t.querySelector("input[checked]").value)});let s=await fetch(urlServer,{method:"POST",headers:headers,body:e});s.ok?alert("Request is enter"):alert("Error "+s.status)}(),s.preventDefault());n.closest(".forms-contact-us__button")&&(!async function(){const t=document.forms.contactUsForm,e=t.querySelector('input[type="file"]').value,s=t.querySelector('input[type="email"]').value,o=t.querySelector('input[type="tel"]').value;let n={file:e,email:s,phone:o},r=await fetch(urlServer,{method:"POST",headers:headers,body:n});r.ok?alert("Request is enter"):alert("Error "+r.status)}(),s.preventDefault());n.classList.contains("arts__showMore")&&(!async function(e){if(!e.classList.contains("_hold")){e.classList.add("_hold"),e.setAttribute("disabled","");let s=await fetch(artsUrl,{method:"GET",headers:headers});if(s.ok){!function(e){const s=document.querySelector("._end");e.arts.forEach(t=>{t.id;const e=t.url,o=t.title,n=t.image;var r=`\n\t\t\t\t<article class="arts__item item-arts">\n               <h3 class="item-arts__title">${o}</h3>\n               <div class="item-arts__body">\n                  <a href="${e}" class="item-arts__image">\n                     <picture>\n                        <source srcset="img/arts/${n}.webp" type="image/webp">\n                        <img src="img/arts/${n}.png" alt="#">\n                     </picture>\n                  </a>\n               </div>\n               <div class="item-arts__text">${t.text}</div>\n               <div class="item-arts__price">от <span>${t.price}</span></div>\n               <button type="button" class="item-arts__buy btn">Заказать</button>\n            </article>\n         `;s.insertAdjacentHTML("afterend",r)}),t()}(await s.json()),e.classList.remove("_hold"),e.remove()}else alert("Error")}}(n),s.preventDefault())})),function(){const t=document.forms.contactUsForm,e=t.contactUsInput,s=t.contactUsPhoto;e.forEach(t=>{const e=t.getAttribute("placeholder");t.addEventListener("focus",(function(e){t.setAttribute("placeholder",""),t.parentElement.classList.add("_focus")})),t.addEventListener("blur",(function(s){t.setAttribute("placeholder",e),t.value||t.parentElement.classList.remove("_focus")}))}),s.addEventListener("change",(function(e){if(s.value.length>35){let e="",n="";for(var o=0;o<s.value.length;o++){let t=String(s.value[o]);if("\\"===t&&(e=String(s.value[o+1])+String(s.value[o+2])+String(s.value[o+3])),"."===t){let e=String(s.value).split(t);n=String(s.value[o-2])+String(s.value[o-1])+t+e[1]}}let r=String(s.value).split(e)[0]+e+"..."+n;t.querySelector(".forms-contact-us__title_photo").innerHTML=`<div class="forms-contact-us__title_photo">Загружено фото <span>${r}</span></div>`}else t.querySelector(".forms-contact-us__title_photo").innerHTML=`<div class="forms-contact-us__title_photo">Загружено фото <span>${s.value}</span></div>`}))}(),t(),async function(){await async function(t){const n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(n.ok){return function(t){const n=document.querySelector(".forms-sale__body");let r=0;const i=t[t.length-1].id;return t.forEach(t=>{const e=t.id,s=t.title,o=t.values;let a=0,l="",c="",d="";r>0&&(c='\n            <button type="button" class="forms-sale__button forms-sale__button_prev _icon-angle-down btn">Предыдущий шаг</button>\n            ',d='\n            style="width: 180px;"\n            '),o.forEach(t=>{let e="";0==a&&(e="checked"),l+=`\n            <li class="forms-sale__item"><input type="radio" ${e} name="radioSale" value="${a}" class="forms-sale__radio">${t}</li>\n            `,a++});let u=`<button type="button" class="forms-sale__button _icon-angle-down btn" ${d}>Следующий шаг</button>`;i==e&&(u=`<button type="button" class="forms-sale__button forms-sale__button_send _icon-angle-down btn" ${d}>Отправить</button>`);let m=`\n         <div data-stepId="${e}" class="forms-sale__qustion">\n            <div class="forms-sale__title">${s}</div>\n            <form action="#" name="saleForm" class="forms-sale__form">\n               <ul class="forms-sale__list">\n                  ${l}\n               </ul>\n            </form>\n            <div class="forms-sale__box-button">\n               ${c}\n               ${u}\n            </div>\n         </div>\n         `;r++,n.insertAdjacentHTML("beforeend",m)}),o(),e(),s(),!0}(await n.json())}}(saleUrl)&&window.addEventListener("resize",()=>{s()})}()};